<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Wowr::API</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Wowr::API</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/wowr_rb.html">
                lib/wowr.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000130">base_url</a>&nbsp;&nbsp;
      <a href="#M000129">clear_cache</a>&nbsp;&nbsp;
      <a href="#M000125">get_arena_team</a>&nbsp;&nbsp;
      <a href="#M000134">get_cache</a>&nbsp;&nbsp;
      <a href="#M000116">get_character</a>&nbsp;&nbsp;
      <a href="#M000117">get_character_sheet</a>&nbsp;&nbsp;
      <a href="#M000119">get_guild</a>&nbsp;&nbsp;
      <a href="#M000126">get_guild_bank_contents</a>&nbsp;&nbsp;
      <a href="#M000127">get_guild_bank_log</a>&nbsp;&nbsp;
      <a href="#M000121">get_item</a>&nbsp;&nbsp;
      <a href="#M000122">get_item_info</a>&nbsp;&nbsp;
      <a href="#M000123">get_item_tooltip</a>&nbsp;&nbsp;
      <a href="#M000132">get_xml</a>&nbsp;&nbsp;
      <a href="#M000133">http_request</a>&nbsp;&nbsp;
      <a href="#M000128">login</a>&nbsp;&nbsp;
      <a href="#M000131">merge_defaults</a>&nbsp;&nbsp;
      <a href="#M000113">new</a>&nbsp;&nbsp;
      <a href="#M000114">search</a>&nbsp;&nbsp;
      <a href="#M000124">search_arena_teams</a>&nbsp;&nbsp;
      <a href="#M000115">search_characters</a>&nbsp;&nbsp;
      <a href="#M000118">search_guilds</a>&nbsp;&nbsp;
      <a href="#M000120">search_items</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">VERSION</td>
          <td>=</td>
          <td class="context-item-value">'0.4.0'</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">caching</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">character_name</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">debug</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">guild_name</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">lang</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">locale</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">realm</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000113" class="method-detail">
        <a name="M000113"></a>

        <div class="method-heading">
          <a href="#M000113" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Constructor Accepts an optional hash of parameters to create defaults for
all <a href="API.html">API</a> requests
</p>
<ul>
<li>options (Hash) - Hash used to set default values for all <a
href="API.html">API</a> requests

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000113-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000113-source">
<pre>
    <span class="ruby-comment cmt"># File lib/wowr.rb, line 86</span>
86:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">options</span> = {})
87:                         <span class="ruby-ivar">@character_name</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:character_name</span>]
88:                         <span class="ruby-ivar">@guild_name</span>                  = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>]
89:                         <span class="ruby-ivar">@realm</span>                                       = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>]
90:                         <span class="ruby-ivar">@locale</span>                                      = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:locale</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">'us'</span>
91:                         <span class="ruby-ivar">@caching</span>                             = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:caching</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">false</span>
92:                         <span class="ruby-ivar">@lang</span>                                                = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lang</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-value str">'default'</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lang</span>]
93:                         <span class="ruby-ivar">@debug</span>                                       = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:debug</span>] <span class="ruby-operator">||</span> <span class="ruby-keyword kw">false</span>
94:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000130" class="method-detail">
        <a name="M000130"></a>

        <div class="method-heading">
          <a href="#M000130" class="method-signature">
          <span class="method-name">base_url</span><span class="method-args">(locale = @locale, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return the base url for the armory, e.g. <a
href="http://eu.wowarmory.com">eu.wowarmory.com</a>/
</p>
<ul>
<li>locale (String) The locale, defaults to that specified in the <a
href="API.html">API</a> constructor

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000130-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000130-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 578</span>
578:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">base_url</span>(<span class="ruby-identifier">locale</span> = <span class="ruby-ivar">@locale</span>, <span class="ruby-identifier">options</span> = {})
579:                         <span class="ruby-identifier">str</span> = <span class="ruby-value str">&quot;&quot;</span>
580:                         
581:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:secure</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>)
582:                                 <span class="ruby-identifier">str</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">'https://'</span>
583:                         <span class="ruby-keyword kw">else</span>
584:                                 <span class="ruby-identifier">str</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">'http://'</span>
585:                         <span class="ruby-keyword kw">end</span>
586:                         
587:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">locale</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'us'</span>)
588:                                 <span class="ruby-identifier">str</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">'www.'</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@@armory_url_base</span>
589:                         <span class="ruby-keyword kw">else</span>
590:                                 <span class="ruby-identifier">str</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">locale</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'.'</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@@armory_url_base</span>
591:                         <span class="ruby-keyword kw">end</span>
592:                         
593:                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">str</span>
594:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000129" class="method-detail">
        <a name="M000129"></a>

        <div class="method-heading">
          <a href="#M000129" class="method-signature">
          <span class="method-name">clear_cache</span><span class="method-args">(cache_path = @@cache_directory_path)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Clear the cache, optional directory name.
</p>
<ul>
<li>cache_path (String) Relative path of the cache directory to be deleted

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000129-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000129-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 567</span>
567:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clear_cache</span>(<span class="ruby-identifier">cache_path</span> = <span class="ruby-ivar">@@cache_directory_path</span>)
568:                         <span class="ruby-keyword kw">begin</span>
569:                                 <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">remove_dir</span>(<span class="ruby-identifier">cache_path</span>)
570:                         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span> 
571:                                 
572:                         <span class="ruby-keyword kw">end</span>
573:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000125" class="method-detail">
        <a name="M000125"></a>

        <div class="method-heading">
          <a href="#M000125" class="method-signature">
          <span class="method-name">get_arena_team</span><span class="method-args">(name, size = nil, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the arena team of the given name and size, on the specified realm.
Returns <a
href="Classes/FullArenaTeam.html">Wowr::Classes::FullArenaTeam</a> Requires
realm.
</p>
<ul>
<li>name (String) Team arena name

</li>
<li>size (Fixnum) Must be 2, 3 or 5

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000125-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000125-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 394</span>
394:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_arena_team</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">size</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span> = {})
395:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
396:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">name</span>
397:                         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">size</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
398:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">size</span>
399:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:team_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>)
400:                         <span class="ruby-keyword kw">else</span>
401:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:team_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">:team_size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">size</span>)
402:                         <span class="ruby-keyword kw">end</span>
403:                         
404:                         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span>)
405:                                                 
406:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:team_name</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:team_name</span>].<span class="ruby-identifier">empty?</span>
407:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">ArenaTeamNameNotSet</span>.<span class="ruby-identifier">new</span>
408:                         <span class="ruby-keyword kw">end</span>
409:                         
410:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>].<span class="ruby-identifier">empty?</span>
411:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">RealmNotSet</span>.<span class="ruby-identifier">new</span>
412:                         <span class="ruby-keyword kw">end</span>
413:                         
414:                         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@@arena_team_sizes</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:team_size</span>])
415:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidArenaTeamSize</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;Arena teams size must be: #{@@arena_team_sizes.inspect}&quot;</span>)
416:                         <span class="ruby-keyword kw">end</span>
417:                         
418:                         <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@arena_team_url</span>, <span class="ruby-identifier">options</span>)
419:                         
420:                         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'arenaTeam'</span>).<span class="ruby-identifier">children</span>.<span class="ruby-identifier">empty?</span>
421:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">ArenaTeam</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'arenaTeam'</span>)
422:                         <span class="ruby-keyword kw">else</span>
423:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">ArenaTeamNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:team_name</span>])
424:                         <span class="ruby-keyword kw">end</span>
425:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000116" class="method-detail">
        <a name="M000116"></a>

        <div class="method-heading">
          <a href="#M000116" class="method-signature">
          <span class="method-name">get_character</span><span class="method-args">(name = @character_name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the full details of a character. Requires realm.
</p>
<ul>
<li>name (String) Name of the character to get, defaults to that specified in
constructor

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000116-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000116-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 180</span>
180:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_character</span>(<span class="ruby-identifier">name</span> = <span class="ruby-ivar">@character_name</span>, <span class="ruby-identifier">options</span> = {})
181:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
182:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">name</span>
183:                         <span class="ruby-keyword kw">else</span>
184:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:character_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>)
185:                                 
186:                                 <span class="ruby-comment cmt"># TODO check</span>
187:                                 <span class="ruby-identifier">options</span> = {<span class="ruby-identifier">:character_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@character_name</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>) <span class="ruby-keyword kw">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@character_name</span>.<span class="ruby-identifier">nil?</span>)
188:                         <span class="ruby-keyword kw">end</span>
189:                         
190:                         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span>)
191:                         
192:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:character_name</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:chracter_name</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
193:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterNameNotSet</span>.<span class="ruby-identifier">new</span>
194:                         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
195:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">RealmNotSet</span>.<span class="ruby-identifier">new</span>
196:                         <span class="ruby-keyword kw">end</span>
197:                         
198:                         <span class="ruby-identifier">character_sheet</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@character_sheet_url</span>, <span class="ruby-identifier">options</span>)
199:                         <span class="ruby-identifier">character_skills</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@character_skills_url</span>, <span class="ruby-identifier">options</span>)
200:                         <span class="ruby-identifier">character_reputation</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@character_reputation_url</span>, <span class="ruby-identifier">options</span>)
201:                         
202:                         <span class="ruby-comment cmt"># FIXME</span>
203:                         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">true</span>
204:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">FullCharacter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">character_sheet</span>,
205:                                                                                                                                                                                                 <span class="ruby-identifier">character_skills</span>,
206:                                                                                                                                                                                                 <span class="ruby-identifier">character_reputation</span>,
207:                                                                                                                                                                                                 <span class="ruby-keyword kw">self</span>)
208:                         <span class="ruby-keyword kw">else</span>
209:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Excceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:character_name</span>])
210:                         <span class="ruby-keyword kw">end</span>
211:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000117" class="method-detail">
        <a name="M000117"></a>

        <div class="method-heading">
          <a href="#M000117" class="method-signature">
          <span class="method-name">get_character_sheet</span><span class="method-args">(name = @character_name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
DEPRECATED See <a href="API.html#M000116">get_character</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000117-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000117-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 216</span>
216:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_character_sheet</span>(<span class="ruby-identifier">name</span> = <span class="ruby-ivar">@character_name</span>, <span class="ruby-identifier">options</span> = {})
217:                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">get_character</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)
218:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000119" class="method-detail">
        <a name="M000119"></a>

        <div class="method-heading">
          <a href="#M000119" class="method-signature">
          <span class="method-name">get_guild</span><span class="method-args">(name = @guild_name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the guild details. Guild name is optional, assuming it&#8216;s set in
the api constructor. Requires realm.
</p>
<ul>
<li>name (String) Name of the guild to retrieve, defaults to that specified in
constructor

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000119-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000119-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 253</span>
253:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_guild</span>(<span class="ruby-identifier">name</span> = <span class="ruby-ivar">@guild_name</span>, <span class="ruby-identifier">options</span> = {})
254:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
255:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">name</span>
256:                         <span class="ruby-keyword kw">else</span>
257:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:guild_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>)
258:                         <span class="ruby-keyword kw">end</span>
259:                         
260:                         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span>)
261:                         
262:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
263:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">GuildNameNotSet</span>.<span class="ruby-identifier">new</span>
264:                         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>].<span class="ruby-identifier">empty?</span>
265:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">RealmNotSet</span>.<span class="ruby-identifier">new</span>
266:                         <span class="ruby-keyword kw">end</span>
267:                         
268:                         <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@guild_info_url</span>, <span class="ruby-identifier">options</span>)
269:                         
270:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'guildKey'</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'guildInfo'</span>).<span class="ruby-identifier">children</span>.<span class="ruby-identifier">empty?</span>
271:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">FullGuild</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">xml</span>)
272:                         <span class="ruby-keyword kw">else</span>
273:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">GuildNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>])
274:                         <span class="ruby-keyword kw">end</span>
275:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000126" class="method-detail">
        <a name="M000126"></a>

        <div class="method-heading">
          <a href="#M000126" class="method-signature">
          <span class="method-name">get_guild_bank_contents</span><span class="method-args">(cookie, guild_name = @guild_name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the current items within the guild bank. Note that the bags and items
the user can see is dependent on their privileges. Requires realm.
</p>
<ul>
<li>cookie (String) Cookie data returned by the <a
href="API.html#M000128">login</a> function.

</li>
<li>guild_name (String) Guild name

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000126-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000126-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 434</span>
434:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_guild_bank_contents</span>(<span class="ruby-identifier">cookie</span>, <span class="ruby-identifier">guild_name</span> = <span class="ruby-ivar">@guild_name</span>, <span class="ruby-identifier">options</span> = {})
435:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">cookie</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
436:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">cookie</span>
437:                         <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">guild_name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
438:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">guild_name</span>
439:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:cookie</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cookie</span>)
440:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:guild_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@guild_name</span>)
441:                         <span class="ruby-keyword kw">else</span>
442:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:cookie</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cookie</span>)
443:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:guild_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">guild_name</span>)
444:                         <span class="ruby-keyword kw">end</span>                  
445:                         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span>)
446:                         
447:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:cookie</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:cookie</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
448:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieNotSet</span>.<span class="ruby-identifier">new</span>
449:                         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
450:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">GuildNameNotSet</span>.<span class="ruby-identifier">new</span>
451:                         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
452:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">RealmNotSet</span>.<span class="ruby-identifier">new</span>
453:                         <span class="ruby-keyword kw">end</span>
454:                         
455:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:secure</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
456:                         
457:                         <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@guild_bank_contents_url</span>, <span class="ruby-identifier">options</span>)
458:                         
459:                         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'guildBank'</span>).<span class="ruby-identifier">children</span>.<span class="ruby-identifier">empty?</span>
460:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">GuildBankContents</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">xml</span>, <span class="ruby-keyword kw">self</span>)
461:                         <span class="ruby-keyword kw">else</span>
462:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">GuildBankNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>])
463:                         <span class="ruby-keyword kw">end</span>
464:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000127" class="method-detail">
        <a name="M000127"></a>

        <div class="method-heading">
          <a href="#M000127" class="method-signature">
          <span class="method-name">get_guild_bank_log</span><span class="method-args">(cookie, name = @guild_name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get a particular page of the guild bank transaction log. Each page contains
up to 1000 transactions, other pages can be specified using :group in the
options hash. Note that data returned is specific to the logged in
user&#8216;s privileges. Requires realm.
</p>
<ul>
<li>cookie (String) Cookie data returned by the <a
href="API.html#M000128">login</a> function

</li>
<li>guild_name (String) Guild name

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000127-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000127-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 474</span>
474:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_guild_bank_log</span>(<span class="ruby-identifier">cookie</span>, <span class="ruby-identifier">name</span> = <span class="ruby-ivar">@guild_name</span>, <span class="ruby-identifier">options</span> = {})
475:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">cookie</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
476:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">cookie</span>
477:                         <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
478:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">name</span>
479:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:cookie</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cookie</span>)
480:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:guild_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@guild_name</span>)
481:                         <span class="ruby-keyword kw">else</span>
482:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:cookie</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cookie</span>)
483:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:guild_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>)
484:                         <span class="ruby-keyword kw">end</span>
485:                         
486:                         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span>)
487:                         
488:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:cookie</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:cookie</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
489:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieNotSet</span>.<span class="ruby-identifier">new</span>
490:                         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
491:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">GuildNameNotSet</span>.<span class="ruby-identifier">new</span>
492:                         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:realm</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
493:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">RealmNotSet</span>.<span class="ruby-identifier">new</span>
494:                         <span class="ruby-keyword kw">end</span>
495:                         
496:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:secure</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
497:                         
498:                         <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@guild_bank_log_url</span>, <span class="ruby-identifier">options</span>)
499:                         
500:                         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'guildBank'</span>).<span class="ruby-identifier">children</span>.<span class="ruby-identifier">empty?</span>
501:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">GuildBankLog</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">xml</span>, <span class="ruby-keyword kw">self</span>)
502:                         <span class="ruby-keyword kw">else</span>
503:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">GuildBankNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:guild_name</span>])
504:                         <span class="ruby-keyword kw">end</span>
505:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000121" class="method-detail">
        <a name="M000121"></a>

        <div class="method-heading">
          <a href="#M000121" class="method-signature">
          <span class="method-name">get_item</span><span class="method-args">(id, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the full item details (<a
href="Classes/FullItem.html">Wowr::Classes::FullItem</a>) with the given
id. Composite of <a
href="Classes/ItemInfo.html">Wowr::Classes::ItemInfo</a> and <a
href="Classes/ItemTooltip.html">Wowr::Classes::ItemTooltip</a> data. Item
requests are identical across realms.
</p>
<ul>
<li>id (Fixnum) ID of the item

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000121-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000121-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 301</span>
301:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_item</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">options</span> = {})
302:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
303:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">id</span>
304:                         <span class="ruby-keyword kw">else</span>
305:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:item_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">id</span>)
306:                         <span class="ruby-keyword kw">end</span>
307:                         
308:                         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span>)
309:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:realm</span>)
310:                         
311:                         <span class="ruby-identifier">info</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@item_info_url</span>, <span class="ruby-identifier">options</span>)
312:                         <span class="ruby-identifier">tooltip</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@item_tooltip_url</span>, <span class="ruby-identifier">options</span>)
313:                         
314:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">info</span><span class="ruby-operator">%</span><span class="ruby-value str">'itemInfo'</span><span class="ruby-operator">%</span><span class="ruby-value str">'item'</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">tooltip</span>.<span class="ruby-identifier">nil?</span>
315:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">FullItem</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">info</span><span class="ruby-operator">%</span><span class="ruby-value str">'itemInfo'</span><span class="ruby-operator">%</span><span class="ruby-value str">'item'</span>, <span class="ruby-identifier">tooltip</span><span class="ruby-operator">%</span><span class="ruby-value str">'itemTooltip'</span>, <span class="ruby-keyword kw">self</span>)
316:                         <span class="ruby-keyword kw">else</span>
317:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">ItemNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:item_id</span>])
318:                         <span class="ruby-keyword kw">end</span>
319:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000122" class="method-detail">
        <a name="M000122"></a>

        <div class="method-heading">
          <a href="#M000122" class="method-signature">
          <span class="method-name">get_item_info</span><span class="method-args">(id, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the basic item information <a
href="Classes/ItemInfo.html">Wowr::Classes::ItemInfo</a>. Item requests are
identical across realms.
</p>
<ul>
<li>id (Fixnum) ID of the item

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000122-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000122-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 326</span>
326:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_item_info</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">options</span> = {})
327:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
328:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">id</span>
329:                         <span class="ruby-keyword kw">else</span>
330:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:item_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">id</span>)
331:                         <span class="ruby-keyword kw">end</span>
332:                         
333:                         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span>)
334:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:realm</span>)
335:                         
336:                         <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@item_info_url</span>, <span class="ruby-identifier">options</span>)
337:                         
338:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'itemInfo'</span><span class="ruby-operator">%</span><span class="ruby-value str">'item'</span>)
339:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">ItemInfo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'itemInfo'</span><span class="ruby-operator">%</span><span class="ruby-value str">'item'</span>, <span class="ruby-keyword kw">self</span>)
340:                         <span class="ruby-keyword kw">else</span>
341:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">ItemNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:item_id</span>])
342:                         <span class="ruby-keyword kw">end</span>
343:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000123" class="method-detail">
        <a name="M000123"></a>

        <div class="method-heading">
          <a href="#M000123" class="method-signature">
          <span class="method-name">get_item_tooltip</span><span class="method-args">(id, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get full item details including stats <a
href="Classes/ItemTooltip.html">Wowr::Classes::ItemTooltip</a>. Item
requests are identical across realms.
</p>
<ul>
<li>id (Fixnum) ID of the item

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000123-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000123-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 350</span>
350:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_item_tooltip</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">options</span> = {})
351:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
352:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">id</span>
353:                         <span class="ruby-keyword kw">else</span>
354:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:item_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">id</span>)
355:                         <span class="ruby-keyword kw">end</span>
356:                         
357:                         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span>)
358:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:realm</span>)
359:                         
360:                         <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@item_tooltip_url</span>, <span class="ruby-identifier">options</span>)
361:                         
362:                         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">xml</span>.<span class="ruby-identifier">nil?</span>
363:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">ItemTooltip</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'itemTooltip'</span>)
364:                         <span class="ruby-keyword kw">else</span>
365:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">ItemNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:item_id</span>])
366:                         <span class="ruby-keyword kw">end</span>
367:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000128" class="method-detail">
        <a name="M000128"></a>

        <div class="method-heading">
          <a href="#M000128" class="method-signature">
          <span class="method-name">login</span><span class="method-args">(username, password)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Logs the user into the armory using their main world of warcraft username
and password. Returns a cookie string used for secure requests like <a
href="API.html#M000126">get_guild_bank_contents</a> and <a
href="API.html#M000127">get_guild_bank_log</a>. Uses SSH to send details to
the <a href="API.html#M000128">login</a> page.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000128-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000128-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 511</span>
511:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">login</span>(<span class="ruby-identifier">username</span>, <span class="ruby-identifier">password</span>)
512:                         <span class="ruby-comment cmt"># url = 'https://eu.wowarmory.com/guild-bank-contents.xml?n=Rawr&amp;r=Trollbane'</span>
513:                         <span class="ruby-identifier">url</span> = <span class="ruby-identifier">base_url</span>(<span class="ruby-ivar">@locale</span>, {<span class="ruby-identifier">:secure</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}) <span class="ruby-operator">+</span> <span class="ruby-ivar">@@login_url</span>
514:                         
515:                         <span class="ruby-identifier">req</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Post</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">url</span>)
516:                         <span class="ruby-identifier">req</span>[<span class="ruby-value str">&quot;user-agent&quot;</span>] = <span class="ruby-value str">&quot;Mozilla/5.0 Gecko/20070219 Firefox/2.0.0.2&quot;</span> <span class="ruby-comment cmt"># ensure returns XML</span>
517:                         <span class="ruby-identifier">req</span>[<span class="ruby-value str">&quot;cookie&quot;</span>] = <span class="ruby-value str">&quot;cookieMenu=all; cookies=true;&quot;</span>
518:                         
519:                         <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">url</span>)
520:                         
521:                         <span class="ruby-identifier">http</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>)
522:                         
523:                         <span class="ruby-comment cmt"># Suppress &quot;warning: peer certificate won't be verified in this SSL session&quot;</span>
524:                         <span class="ruby-identifier">http</span>.<span class="ruby-identifier">verify_mode</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_NONE</span>
525:                         <span class="ruby-identifier">http</span>.<span class="ruby-identifier">use_ssl</span> = <span class="ruby-keyword kw">true</span>
526:                         
527:                         <span class="ruby-identifier">req</span>.<span class="ruby-identifier">set_form_data</span>({<span class="ruby-value str">'accountName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">username</span>, <span class="ruby-value str">'password'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">password</span>}, <span class="ruby-value str">'&amp;'</span>)
528:                         
529:                         
530:                         <span class="ruby-identifier">http</span>.<span class="ruby-identifier">start</span> <span class="ruby-keyword kw">do</span>
531:                                 <span class="ruby-identifier">res</span> = <span class="ruby-identifier">http</span>.<span class="ruby-identifier">request</span>(<span class="ruby-identifier">req</span>)
532:                                 
533:                                 <span class="ruby-identifier">tries</span> = <span class="ruby-value">0</span>
534:                                 <span class="ruby-identifier">response</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">res</span>
535:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTPSuccess</span>, <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTPRedirection</span>
536:                                                 <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span>
537:                                         <span class="ruby-keyword kw">else</span>
538:                                                 <span class="ruby-identifier">tries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
539:                                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tries</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@@max_connection_tries</span>
540:                                                         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">NetworkTimeout</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'Timed out'</span>)
541:                                                 <span class="ruby-keyword kw">else</span>
542:                                                         <span class="ruby-keyword kw">retry</span>
543:                                                 <span class="ruby-keyword kw">end</span>
544:                                         <span class="ruby-keyword kw">end</span>
545:                                 
546:                                 <span class="ruby-identifier">doc</span> = <span class="ruby-constant">Hpricot</span>.<span class="ruby-constant">XML</span>(<span class="ruby-identifier">response</span>)
547:                                 
548:                                 <span class="ruby-comment cmt"># error = 0 nothing provided</span>
549:                                 <span class="ruby-comment cmt"># error = 1 invalid credentials</span>
550:                                 <span class="ruby-comment cmt"># TODO: Detect different kinds of errors</span>
551:                                 <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">doc</span><span class="ruby-operator">%</span><span class="ruby-value str">'login'</span>)
552:                                         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidLoginDetails</span>
553:                                 <span class="ruby-keyword kw">else</span>
554:                                         <span class="ruby-identifier">cookie</span> = <span class="ruby-keyword kw">nil</span>
555:                                         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">header</span>[<span class="ruby-value str">'set-cookie'</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/JSESSIONID=(.*?);/</span>) {
556:                                                 <span class="ruby-identifier">cookie</span> = <span class="ruby-value str">'JSESSIONID='</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$1</span> <span class="ruby-operator">+</span> <span class="ruby-value str">';'</span>
557:                                         }
558:                                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">cookie</span>
559:                                 <span class="ruby-keyword kw">end</span>
560:                         <span class="ruby-keyword kw">end</span>
561:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000114" class="method-detail">
        <a name="M000114"></a>

        <div class="method-heading">
          <a href="#M000114" class="method-signature">
          <span class="method-name">search</span><span class="method-args">(string, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
General-purpose <a href="API.html#M000114">search</a> All specific searches
are wrappers around this method. Best to use those instead. Returns an
array of results of the type requested (<a
href="Classes/SearchCharacter.html">Wowr::Classes::SearchCharacter</a>
etc.) or an empty array. Searches across all realms. Caching is disabled
for searching.
</p>
<ul>
<li>string (String) Search string

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000114-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000114-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 104</span>
104:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">options</span> = {})
105:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">string</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
106:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">string</span>
107:                         <span class="ruby-keyword kw">else</span>
108:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:search</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">string</span>)
109:                         <span class="ruby-keyword kw">end</span>
110:                         
111:                         <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span>)
112:                         
113:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:search</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:search</span>].<span class="ruby-identifier">empty?</span>
114:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">NoSearchString</span>.<span class="ruby-identifier">new</span>
115:                         <span class="ruby-keyword kw">end</span>
116:                         
117:                         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@@search_types</span>.<span class="ruby-identifier">has_value?</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:type</span>])
118:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidSearchType</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:type</span>])
119:                         <span class="ruby-keyword kw">end</span>
120:                         
121:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:caching</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>)
122:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:realm</span>) <span class="ruby-comment cmt"># all searches are across realms</span>
123:                                                 
124:                         <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">get_xml</span>(<span class="ruby-ivar">@@search_url</span>, <span class="ruby-identifier">options</span>)
125:                         
126:                         <span class="ruby-identifier">results</span> = []
127:                                                 
128:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">xml</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'armorySearch'</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'armorySearch'</span><span class="ruby-operator">%</span><span class="ruby-value str">'searchResults'</span>)
129:                                 <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:type</span>]
130:                                         
131:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-ivar">@@search_types</span>[<span class="ruby-identifier">:item</span>]
132:                                                 (<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'armorySearch'</span><span class="ruby-operator">%</span><span class="ruby-value str">'searchResults'</span><span class="ruby-operator">%</span><span class="ruby-value str">'items'</span><span class="ruby-operator">/</span><span class="ruby-identifier">:item</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>
133:                                                         <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">SearchItem</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">item</span>)
134:                                                 <span class="ruby-keyword kw">end</span>
135:                                         
136:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-ivar">@@search_types</span>[<span class="ruby-identifier">:character</span>]
137:                                                 (<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'armorySearch'</span><span class="ruby-operator">%</span><span class="ruby-value str">'searchResults'</span><span class="ruby-operator">%</span><span class="ruby-value str">'characters'</span><span class="ruby-operator">/</span><span class="ruby-identifier">:character</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">char</span><span class="ruby-operator">|</span>
138:                                                         <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">SearchCharacter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">char</span>, <span class="ruby-keyword kw">self</span>)
139:                                                 <span class="ruby-keyword kw">end</span>
140:                                         
141:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-ivar">@@search_types</span>[<span class="ruby-identifier">:guild</span>]
142:                                                 (<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'armorySearch'</span><span class="ruby-operator">%</span><span class="ruby-value str">'searchResults'</span><span class="ruby-operator">%</span><span class="ruby-value str">'guilds'</span><span class="ruby-operator">/</span><span class="ruby-identifier">:guild</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">guild</span><span class="ruby-operator">|</span>
143:                                                         <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">SearchGuild</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">guild</span>)
144:                                                 <span class="ruby-keyword kw">end</span>
145:                                         
146:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-ivar">@@search_types</span>[<span class="ruby-identifier">:arena_team</span>]
147:                                                 (<span class="ruby-identifier">xml</span><span class="ruby-operator">%</span><span class="ruby-value str">'armorySearch'</span><span class="ruby-operator">%</span><span class="ruby-value str">'searchResults'</span><span class="ruby-operator">%</span><span class="ruby-value str">'arenaTeams'</span><span class="ruby-operator">/</span><span class="ruby-identifier">:arenaTeam</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">team</span><span class="ruby-operator">|</span>
148:                                                         <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Classes</span><span class="ruby-operator">::</span><span class="ruby-constant">SearchArenaTeam</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">team</span>)
149:                                                 <span class="ruby-keyword kw">end</span>
150:                                 <span class="ruby-keyword kw">end</span>
151:                         <span class="ruby-keyword kw">end</span>
152:                         
153:                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">results</span>
154:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000124" class="method-detail">
        <a name="M000124"></a>

        <div class="method-heading">
          <a href="#M000124" class="method-signature">
          <span class="method-name">search_arena_teams</span><span class="method-args">(name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Search for arena teams with the given name of any size. Returns an array of
<a href="Classes/SearchArenaTeam.html">Wowr::Classes::SearchArenaTeam</a>
Searches across all realms. Caching is disabled for searching.
</p>
<ul>
<li>name (String) Name of the arena team to seach for

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000124-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000124-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 376</span>
376:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search_arena_teams</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {})
377:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
378:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">name</span>
379:                         <span class="ruby-keyword kw">else</span>
380:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:search</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>)
381:                         <span class="ruby-keyword kw">end</span>
382:                         
383:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@@search_types</span>[<span class="ruby-identifier">:arena_team</span>])
384:                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">search</span>(<span class="ruby-identifier">options</span>)
385:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000115" class="method-detail">
        <a name="M000115"></a>

        <div class="method-heading">
          <a href="#M000115" class="method-signature">
          <span class="method-name">search_characters</span><span class="method-args">(name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Characters Returns an array of results of <a
href="Classes/SearchCharacter.html">Wowr::Classes::SearchCharacter</a> or
an empty array. Searches across all realms. Caching is disabled for
searching. Parameters
</p>
<ul>
<li>name (String) Name of the character to <a
href="API.html#M000114">search</a> for

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000115-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000115-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 164</span>
164:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search_characters</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {})
165:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
166:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">name</span>
167:                         <span class="ruby-keyword kw">else</span>
168:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:search</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>)
169:                         <span class="ruby-keyword kw">end</span>
170:                         
171:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@@search_types</span>[<span class="ruby-identifier">:character</span>])
172:                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">search</span>(<span class="ruby-identifier">options</span>)
173:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000118" class="method-detail">
        <a name="M000118"></a>

        <div class="method-heading">
          <a href="#M000118" class="method-signature">
          <span class="method-name">search_guilds</span><span class="method-args">(name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Find all guilds with the given string, return array of <a
href="Classes/SearchGuild.html">Wowr::Classes::SearchGuild</a>. Searches
across all realms. Caching is disabled for searching.
</p>
<ul>
<li>name (String) Name of the guild to <a href="API.html#M000114">search</a>
for

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000118-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000118-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 235</span>
235:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search_guilds</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {})
236:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
237:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">name</span>
238:                         <span class="ruby-keyword kw">else</span>
239:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:search</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>)
240:                         <span class="ruby-keyword kw">end</span>
241:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:realm</span>)
242:                         
243:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@@search_types</span>[<span class="ruby-identifier">:guild</span>])
244:                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">search</span>(<span class="ruby-identifier">options</span>)
245:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000120" class="method-detail">
        <a name="M000120"></a>

        <div class="method-heading">
          <a href="#M000120" class="method-signature">
          <span class="method-name">search_items</span><span class="method-args">(name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Search for items with the specified name. Returns an array of <a
href="Classes/SearchItem.html">Wowr::Classes::SearchItem</a>. Searches
across all realms. Caching is disabled for searching.
</p>
<ul>
<li>name (String) Name of the item

</li>
<li>options (Hash) Optional hash of arguments identical to those used in the <a
href="API.html">API</a> constructor (realm, debug, cache etc.)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000120-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000120-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 284</span>
284:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search_items</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {})
285:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>))
286:                                 <span class="ruby-identifier">options</span> = <span class="ruby-identifier">name</span>
287:                         <span class="ruby-keyword kw">else</span>
288:                                 <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:search</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>)
289:                         <span class="ruby-keyword kw">end</span>
290:                         
291:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@@search_types</span>[<span class="ruby-identifier">:item</span>])
292:                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">search</span>(<span class="ruby-identifier">options</span>)
293:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000134" class="method-detail">
        <a name="M000134"></a>

        <div class="method-heading">
          <a href="#M000134" class="method-signature">
          <span class="method-name">get_cache</span><span class="method-args">(url, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Translate the specified URL to the cache location, and return the file If
the cache does not exist, get the contents using <a
href="API.html#M000133">http_request</a> and create it
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000134-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000134-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 712</span>
712:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_cache</span>(<span class="ruby-identifier">url</span>, <span class="ruby-identifier">options</span> = {})
713:                         <span class="ruby-identifier">path</span> = <span class="ruby-ivar">@@cache_directory_path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lang</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">'/'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">url_to_filename</span>(<span class="ruby-identifier">url</span>)
714:                         
715:                         <span class="ruby-comment cmt"># file doesn't exist, make it</span>
716:                         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span>)
717:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:debug</span>]
718:                                         <span class="ruby-identifier">puts</span> <span class="ruby-value str">'Cache doesn\'t exist, making: '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">path</span>
719:                                 <span class="ruby-keyword kw">end</span>
720:                                 
721:                                 <span class="ruby-comment cmt"># make sure dir exists</span>
722:                                 <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-identifier">localised_cache_path</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lang</span>])) <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">localised_cache_path</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lang</span>]))
723:                                 
724:                                 <span class="ruby-identifier">xml_content</span> = <span class="ruby-identifier">http_request</span>(<span class="ruby-identifier">url</span>, <span class="ruby-identifier">options</span>)
725:                                 
726:                                 <span class="ruby-comment cmt"># write the cache</span>
727:                                 <span class="ruby-identifier">file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">WRONLY</span><span class="ruby-operator">|</span><span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">TRUNC</span><span class="ruby-operator">|</span><span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">CREAT</span>)
728:                                 <span class="ruby-identifier">file</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">xml_content</span>)
729:                                 <span class="ruby-identifier">file</span>.<span class="ruby-identifier">close</span>
730:                         
731:                         <span class="ruby-comment cmt"># file exists, return the contents</span>
732:                         <span class="ruby-keyword kw">else</span>
733:                                 <span class="ruby-identifier">puts</span> <span class="ruby-value str">'Cache already exists, read: '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:debug</span>]
734:                                 
735:                                 <span class="ruby-identifier">file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value str">'r'</span>)
736:                                 <span class="ruby-identifier">xml_content</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">read</span>
737:                                 <span class="ruby-identifier">file</span>.<span class="ruby-identifier">close</span>
738:                         <span class="ruby-keyword kw">end</span>
739:                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">xml_content</span>
740:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000132" class="method-detail">
        <a name="M000132"></a>

        <div class="method-heading">
          <a href="#M000132" class="method-signature">
          <span class="method-name">get_xml</span><span class="method-args">(url, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return an Hpricot document for the given URL TODO: Tidy up?
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000132-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000132-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 617</span>
617:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_xml</span>(<span class="ruby-identifier">url</span>, <span class="ruby-identifier">options</span> = {})
618:                         
619:                         <span class="ruby-comment cmt"># better way of doing this?</span>
620:                         <span class="ruby-comment cmt"># Map custom keys to the HTTP request values</span>
621:                         <span class="ruby-identifier">reqs</span> = {
622:                                 <span class="ruby-identifier">:character_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'n'</span>,
623:                                 <span class="ruby-identifier">:realm</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'r'</span>,
624:                                 <span class="ruby-identifier">:search</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'searchQuery'</span>,
625:                                 <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'searchType'</span>,
626:                                 <span class="ruby-identifier">:guild_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'n'</span>,
627:                                 <span class="ruby-identifier">:item_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'i'</span>,
628:                                 <span class="ruby-identifier">:team_size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'ts'</span>,
629:                                 <span class="ruby-identifier">:team_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'t'</span>,
630:                                 <span class="ruby-identifier">:group</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'group'</span>
631:                         }
632:                         
633:                         
634:                         <span class="ruby-identifier">params</span> = []
635:                         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
636:                                 <span class="ruby-identifier">params</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{reqs[key]}=#{u(value)}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">reqs</span>[<span class="ruby-identifier">key</span>]
637:                         <span class="ruby-keyword kw">end</span>
638:                         
639:                         <span class="ruby-identifier">query</span> = <span class="ruby-value str">'?'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'&amp;'</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
640:                         
641:                         <span class="ruby-identifier">base</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">base_url</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:locale</span>], <span class="ruby-identifier">options</span>)
642:                         <span class="ruby-identifier">full_query</span> = <span class="ruby-identifier">base</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">url</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">query</span>
643:                         
644:                         <span class="ruby-identifier">puts</span> <span class="ruby-identifier">full_query</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:debug</span>]
645:                         
646:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:caching</span>]
647:                                 <span class="ruby-identifier">response</span> = <span class="ruby-identifier">get_cache</span>(<span class="ruby-identifier">full_query</span>, <span class="ruby-identifier">options</span>)
648:                         <span class="ruby-keyword kw">else</span>
649:                                 <span class="ruby-identifier">response</span> = <span class="ruby-identifier">http_request</span>(<span class="ruby-identifier">full_query</span>, <span class="ruby-identifier">options</span>)
650:                         <span class="ruby-keyword kw">end</span>
651:                                                 
652:                         <span class="ruby-identifier">doc</span> = <span class="ruby-constant">Hpricot</span>.<span class="ruby-constant">XML</span>(<span class="ruby-identifier">response</span>)
653:                         <span class="ruby-identifier">errors</span> = <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">search</span>(<span class="ruby-value str">&quot;*[@errCode]&quot;</span>)
654:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
655:                                 <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">error</span><span class="ruby-operator">|</span>
656:                                         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-identifier">raise_me</span>(<span class="ruby-identifier">error</span>[<span class="ruby-identifier">:errCode</span>], <span class="ruby-identifier">options</span>)
657:                                 <span class="ruby-keyword kw">end</span>
658:                         <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">doc</span><span class="ruby-operator">%</span><span class="ruby-value str">'page'</span>).<span class="ruby-identifier">nil?</span>
659:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">EmptyPage</span>
660:                         <span class="ruby-keyword kw">else</span>
661:                                 <span class="ruby-keyword kw">return</span> (<span class="ruby-identifier">doc</span><span class="ruby-operator">%</span><span class="ruby-value str">'page'</span>)
662:                         <span class="ruby-keyword kw">end</span>
663:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000133" class="method-detail">
        <a name="M000133"></a>

        <div class="method-heading">
          <a href="#M000133" class="method-signature">
          <span class="method-name">http_request</span><span class="method-args">(url, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Perform an HTTP request and return the contents of the document
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000133-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000133-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 667</span>
667:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">http_request</span>(<span class="ruby-identifier">url</span>, <span class="ruby-identifier">options</span> = {})
668:                         <span class="ruby-identifier">req</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Get</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">url</span>)
669:                         <span class="ruby-identifier">req</span>[<span class="ruby-value str">&quot;user-agent&quot;</span>] = <span class="ruby-value str">&quot;Mozilla/5.0 Gecko/20070219 Firefox/2.0.0.2&quot;</span> <span class="ruby-comment cmt"># ensure returns XML</span>
670:                         <span class="ruby-identifier">req</span>[<span class="ruby-value str">&quot;cookie&quot;</span>] = <span class="ruby-value str">&quot;cookieMenu=all; cookieLangId=&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:lang</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;; cookies=true;&quot;</span>
671:                         
672:                         <span class="ruby-identifier">req</span>[<span class="ruby-value str">&quot;cookie&quot;</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:cookie</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:cookie</span>]
673:                         
674:                         <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">url</span>)
675:                         
676:                         <span class="ruby-identifier">http</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>)
677:                         
678:                         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:secure</span>])
679:                                 <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Secure authentication&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:debug</span>]
680: 
681:                                 <span class="ruby-identifier">http</span>.<span class="ruby-identifier">verify_mode</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_NONE</span>
682:                                 <span class="ruby-identifier">http</span>.<span class="ruby-identifier">use_ssl</span> = <span class="ruby-keyword kw">true</span>
683:                         <span class="ruby-keyword kw">end</span>
684:                   
685:                         
686:                         <span class="ruby-keyword kw">begin</span>
687:                           <span class="ruby-identifier">http</span>.<span class="ruby-identifier">start</span> <span class="ruby-keyword kw">do</span>
688:                             <span class="ruby-identifier">res</span> = <span class="ruby-identifier">http</span>.<span class="ruby-identifier">request</span> <span class="ruby-identifier">req</span>
689:                                         <span class="ruby-comment cmt"># response = res.body</span>
690:                                         
691:                                         <span class="ruby-identifier">tries</span> = <span class="ruby-value">0</span>
692:                                         <span class="ruby-identifier">response</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">res</span>
693:                                                 <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTPSuccess</span>, <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTPRedirection</span>
694:                                                         <span class="ruby-identifier">res</span>.<span class="ruby-identifier">body</span>
695:                                                 <span class="ruby-keyword kw">else</span>
696:                                                         <span class="ruby-identifier">tries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
697:                                                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tries</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@@max_connection_tries</span>
698:                                                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">NetworkTimeout</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'Timed out'</span>)
699:                                                         <span class="ruby-keyword kw">else</span>
700:                                                                 <span class="ruby-keyword kw">retry</span>
701:                                                         <span class="ruby-keyword kw">end</span>
702:                                                 <span class="ruby-keyword kw">end</span>
703:                           <span class="ruby-keyword kw">end</span>
704:                         <span class="ruby-keyword kw">rescue</span> 
705:                                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">Wowr</span><span class="ruby-operator">::</span><span class="ruby-constant">Exceptions</span><span class="ruby-operator">::</span><span class="ruby-constant">ServerDoesNotExist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'Specified server at '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">url</span> <span class="ruby-operator">+</span> <span class="ruby-value str">' does not exist.'</span>);
706:                         <span class="ruby-keyword kw">end</span>
707:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000131" class="method-detail">
        <a name="M000131"></a>

        <div class="method-heading">
          <a href="#M000131" class="method-signature">
          <span class="method-name">merge_defaults</span><span class="method-args">(options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Merge the defaults specified in the constructor with those supplied,
overriding any defaults with those supplied
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000131-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000131-source">
<pre>
     <span class="ruby-comment cmt"># File lib/wowr.rb, line 601</span>
601:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge_defaults</span>(<span class="ruby-identifier">options</span> = {})
602:                         <span class="ruby-identifier">defaults</span> = {}
603:                         <span class="ruby-comment cmt"># defaults[:character_name] = @charater_name if @charater_name</span>
604:                         <span class="ruby-comment cmt"># defaults[:guild_name]      = @guild_name if @guild_name</span>
605:                         <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:realm</span>]             = <span class="ruby-ivar">@realm</span>          <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@realm</span>
606:                         <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:locale</span>]    = <span class="ruby-ivar">@locale</span>         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@locale</span>
607:                         <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:lang</span>]              = <span class="ruby-ivar">@lang</span>            <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lang</span>
608:                         <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:caching</span>]   = <span class="ruby-ivar">@caching</span>       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@caching</span>
609:                         <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:debug</span>]             = <span class="ruby-ivar">@debug</span>          <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug</span>
610:                         
611:                         <span class="ruby-comment cmt"># overwrite defaults with any given options</span>
612:                         <span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">options</span>)
613:                 <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>